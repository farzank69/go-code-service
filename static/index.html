<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go Fiber Code Service Tester</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <div class="container">
        <h1>Go Fiber Code Service Tester</h1>
        
        <div class="api-section">
            <h2>1. Run Code API</h2>
            <label class="label">Enter Code:</label>
            <textarea id="runCode" placeholder="console.log('Hello World')"></textarea>
            <button onclick="runCode()">Run Code</button>
            <div id="runOutput" class="output">Output will appear here...</div>
        </div>

        <div class="api-section">
            <h2>2. Auto-Fix API</h2>
            <label class="label">Enter Code to Fix:</label>
            <textarea id="fixCode" placeholder="let x = 10
console.log(x)"></textarea>
            <button onclick="autoFix()">Auto-Fix Code</button>
            <div id="fixOutput" class="output">Fixed code will appear here...</div>
        </div>

        <div class="api-section">
            <h2>3. Help API</h2>
            <label class="label">Enter Query:</label>
            <input type="text" id="helpQuery" placeholder="How do I use loops?">
            <button onclick="getHelp()">Get Help</button>
            <div id="helpOutput" class="output">Help response will appear here...</div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:3000';

        async function runCode() {
            const code = document.getElementById('runCode').value;
            const output = document.getElementById('runOutput');
            
            if (!code.trim()) {
                output.className = 'output error';
                output.textContent = 'Please enter some code';
                return;
            }

            try {
                const response = await fetch(`${API_URL}/run`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ code: code })
                });

                const data = await response.json();
                
                if (data.error) {
                    output.className = 'output error';
                    output.textContent = `Error: ${data.error}`;
                } else {
                    output.className = 'output success';
                    output.textContent = data.output;
                }
            } catch (error) {
                output.className = 'output error';
                output.textContent = `Request failed: ${error.message}`;
            }
        }

        async function autoFix() {
            const code = document.getElementById('fixCode').value;
            const output = document.getElementById('fixOutput');
            
            if (!code.trim()) {
                output.className = 'output error';
                output.textContent = 'Please enter some code';
                return;
            }

            try {
                const response = await fetch(`${API_URL}/autofix`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ code: code })
                });

                const data = await response.json();
                
                if (data.error) {
                    output.className = 'output error';
                    output.textContent = `Error: ${data.error}`;
                } else {
                    output.className = 'output success';
                    output.textContent = data.output;
                }
            } catch (error) {
                output.className = 'output error';
                output.textContent = `Request failed: ${error.message}`;
            }
        }

        async function getHelp() {
            const query = document.getElementById('helpQuery').value;
            const output = document.getElementById('helpOutput');
            
            if (!query.trim()) {
                output.className = 'output error';
                output.textContent = 'Please enter a query';
                return;
            }

            try {
                const response = await fetch(`${API_URL}/help`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ query: query })
                });

                const data = await response.json();
                
                if (data.error) {
                    output.className = 'output error';
                    output.textContent = `Error: ${data.error}`;
                } else {
                    output.className = 'output success';
                    output.textContent = data.output;
                }
            } catch (error) {
                output.className = 'output error';
                output.textContent = `Request failed: ${error.message}`;
            }
        }
    </script>
</body>
</html>
